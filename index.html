<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gialle Bonangs</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans', sans-serif; text-align: center; background: #fafafa; padding: 2rem; user-select: none;}
    a { display: inline-block; padding: 10px 10px; margin: 10px; border-radius: 10px; color: white; cursor: pointer; min-width: 70px;}
    .ruby { background: linear-gradient(45deg, #f11755, #f55f79); box-shadow: 0 4px 15px rgba(241,39,17,0.5);}
    .aqua { background: linear-gradient(45deg, #36d1dc, #5b86e5); box-shadow: 0 4px 15px rgba(100,180,256,0.5);}
    .emra { background: linear-gradient(45deg, #56767f, #a8e063); box-shadow: 0 4px 15px rgba(100,200,50,0.5);}
    .amet { background: linear-gradient(45deg, #bc4edd, #d807bb); box-shadow: 0 4px 15px rgba(200,100,256,0.5);}
    .gold { background: linear-gradient(45deg, #eedd11, #ffee88); box-shadow: 0 4px 15px rgba(200,200,100,0.5);}
    .turq { background: linear-gradient(45deg, #1abc9c, #00ffff); box-shadow: 0 4px 15px rgba(200,200,100,0.5);}
    .orng { background: linear-gradient(45deg, #ee6611, #f5aa42); box-shadow: 0 4px 15px rgba(200,178,100,0.5);}
    .moss { background: linear-gradient(45deg, #345678, #22dd32); box-shadow: 0 4px 15px rgba(200,178,100,0.5);}
    a:active { transform: scale(0.95) translateY(2px); box-shadow: inset 0 4px 8px rgba(0,0,0,0.4);}
  </style>
</head>
<body>

<h1>Gialle's Tones</h1>

<label>Dasar (Hz): <input type="number" id="baseFreq" value="220" min="20" max="2000" step="1"></label>
<br><br>

<select id="modeSelect">
  <option value="scale">Scale Select</option>
  <option value="keyboard">Keyboard Mode</option>
</select>
<select id="scaleSelect" style="display:none;">
  <option value="salendrop">Salendro Padantara 5EDO</option>
  <option value="salendrob">Salendro Bedantara JI</option>
  <option value="degung">Degung JI</option>
  <option value="madenda">Madenda JI</option>
  <option value="uni">Extended JI</option>
</select>

<div id="scaleContainer"></div>

<script>
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
const activeNotes = {};
let keyBindings = [];

function startNote(key, cents) {
  if (activeNotes[key]) return;
  const baseFreq = parseFloat(document.getElementById('baseFreq').value) || 220;
  const freq = baseFreq * Math.pow(2, cents / 1200);
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  gain.gain.setValueAtTime(0.4, audioCtx.currentTime);
  osc.type = 'sine';
  osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
  osc.connect(gain).connect(audioCtx.destination);
  osc.start();
  activeNotes[key] = {osc, gain};
}
function stopNote(key) {
  if (!activeNotes[key]) return;
  const { osc, gain } = activeNotes[key];
  gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 1);
  osc.stop(audioCtx.currentTime + 1);
  delete activeNotes[key];
}

const scales = {
  salendrop: { 
    rows: [{name:"Tugu<br>1", cents:0, cls:"ruby"},{name:"Singgul<br>5", cents:240, cls:"orng"},{name:"Galimer<br>4", cents:480, cls:"emra"},{name:"Panelu<br>3", cents:720, cls:"turq"},{name:"Loloran<br>2", cents:960, cls:"amet"}],
    keys: "1234567890qwertyuiopasdfghjkl"
  },
  degung: {
    rows: [{name:"Tugu<br>1", cents:0, cls:"ruby"},{name:"Singgul<br>5", cents:386, cls:"gold"},{name:"Galimer<br>4", cents:498, cls:"emra"},{name:"Panelu<br>3", cents:702, cls:"turq"},{name:"Loloran<br>2", cents:1088, cls:"amet"}],
    keys: "1234567890qwertyuiopasdfghjkl"
  },
  madenda: {
    rows: [{name:"Tugu<br>1", cents:0, cls:"ruby"},{name:"Singgul<br>5", cents:386, cls:"gold"},{name:"Galimer<br>4", cents:590, cls:"moss"},{name:"Panelu<br>3", cents:702, cls:"turq"},{name:"Loloran<br>2", cents:1088, cls:"amet"}],
    keys: "1234567890qwertyuiopasdfghjkl"
  },
 salendrob: {
    rows: [{name:"Tugu<br>1", cents:0, cls:"ruby"},{name:"Singgul<br>+5", cents:204, cls:"orng"},{name:"Galimer<br>4", cents:498, cls:"emra"},{name:"Panelu<br>3", cents:702, cls:"turq"},{name:"Loloran<br>2", cents:1018, cls:"amet"}],
    keys: "1234567890qwertyuiopasdfghjkl;zxcvbnm,."
  },
  uni: {
    rows: [{name:"Tugu<br>1", cents:0, cls:"ruby"},{name:"Tugu-<br>-1", cents:112, cls:"ruby"},{name:"Sorog<br>+5", cents:204, cls:"orng"},{name:"Singgul<br>5", cents:386, cls:"gold"},{name:"Galimer<br>4", cents:498, cls:"emra"},{name:"Galimer-<br>-4", cents:590, cls:"moss"},{name:"Panelu<br>3", cents:702, cls:"turq"},{name:"Bungur<br>-3", cents:884, cls:"aqua"},{name:"Loloran+<br>+2", cents:1018, cls:"amet"},{name:"Loloran<br>2", cents:1088, cls:"amet"}],
    keys: "1234567890qwertyuiopasdfghjkl;zxcvbnm,."
  }
};

function buildScale(scaleName, keys, rows, container, octaves) {
  let noteIndex=0;
  for (let o=0; o<octaves; o++) {
    rows.forEach((note,i)=>{
      const cents=note.cents+(1200*o);
      const keyId=scaleName+o+i;
      const keyChar=keys[noteIndex];
      const a=document.createElement('a');
      a.className=note.cls;
      a.innerHTML=`${note.name}<br>[${keyChar}]<br>${cents}c`;
      a.onmousedown=()=>startNote(keyId,cents);
      a.onmouseup=a.onmouseleave=()=>stopNote(keyId);
      a.ontouchstart=(e)=>{e.preventDefault();startNote(keyId,cents);};
      a.ontouchend=()=>stopNote(keyId);
      container.appendChild(a);
      keyBindings.push({key:keyChar, id:keyId, cents});
      noteIndex++;
    });
    container.appendChild(document.createElement('br'));
  }
}

function renderUI() {
  const mode = document.getElementById("modeSelect").value;
  const container = document.getElementById("scaleContainer");
  container.innerHTML = "";
  keyBindings = [];
  const scaleSelect = document.getElementById("scaleSelect");

  if (mode === "scale") {
    scaleSelect.style.display = "";
    const scaleName = scaleSelect.value;
    const scale = scales[scaleName];
    buildScale(scaleName, scale.keys, scale.rows, container, 5);
  } else {
    scaleSelect.style.display = "none";
    Object.keys(scales).forEach(scaleName=>{
      const scale = scales[scaleName];
      const div = document.createElement('div');
      div.innerHTML = `<h3>${scaleName.toUpperCase()}</h3>`;
      container.appendChild(div);
      buildScale(scaleName, scale.keys, scale.rows, container, 2);
    });
  }
}

document.getElementById("modeSelect").addEventListener("change", renderUI);
document.getElementById("scaleSelect").addEventListener("change", renderUI);
document.addEventListener('keydown',(e)=>{if(e.repeat)return;const b=keyBindings.find(b=>b.key===e.key);if(b)startNote(b.id,b.cents);});
document.addEventListener('keyup',(e)=>{const b=keyBindings.find(b=>b.key===e.key);if(b)stopNote(b.id);});

renderUI();
</script>

</body>
</html>
